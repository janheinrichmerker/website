 <!doctype html> <html> <head> <meta charset=utf-8> <meta name=viewport content="width=device-width,minimum-scale=1,initial-scale=1,user-scalable=yes"> <title>Flickr grid layout</title> <script src=../../../webcomponentsjs/webcomponents-lite.min.js></script> <link rel=import href=../../../polymer/polymer.min.html> <link rel=import href=../../../iron-scroll-threshold/iron-scroll-threshold.min.html> <link rel=import href=../../../iron-ajax/iron-ajax.min.html> <link rel=import href=../../../paper-styles/shadow.min.html> <link rel=import href=../../../paper-spinner/paper-spinner.min.html> <link rel=import href=../../app-header-layout/app-header-layout.min.html> <link rel=import href=../../app-scroll-effects/effects/waterfall.min.html> <link rel=import href=../../app-header/app-header.min.html> <link rel=import href=../../app-toolbar/app-toolbar.min.html> <link rel=import href=../app-grid-style.min.html> <style>body{font-family:Roboto,Noto,sans-serif;background-color:#f0f0f0;margin:0}</style> </head> <body> <dom-module id=x-grid> <template> <style include=app-grid-style>:host{display:block;--app-grid-columns:4;--app-grid-gutter:5px;--app-grid-item-height:250px;--app-grid-expandible-item-columns:4}app-header{background-color:rgba(255,255,255,.8);color:#000;-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}ul{padding:0;list-style:none}[main-title]{font-weight:700}.centered-container{margin-top:40px;max-width:1000px;margin:40px auto}.loadingIndicator{font-size:16px;text-align:center;height:60px}.loadingIndicator paper-spinner{margin-right:20px;vertical-align:middle}.item{background-color:#fff;background-size:cover;background-position:center center}.item:nth-child(5+1){@apply(--app-grid-expandible-item);height:400px}@media (max-width:799px){:host{--app-grid-columns:2;--app-grid-gutter:5px;--app-grid-item-height:200px}.centered-container{margin:10px 5px}.item:nth-child(5+1){height:250px}[spacer]{margin-left:0}}</style> <app-header-layout> <app-header condenses reveals effects=waterfall> <app-toolbar> <div spacer main-title>Flickr grid layout</div> </app-toolbar> </app-header> <div class=centered-container> <ul class=app-grid> <template is=dom-repeat items=[[photos]] as=photo> <li class=item style$=[[_getItemStyle(photo)]]></li> </template> </ul> </div> </app-header-layout> <div class=loadingIndicator hidden$=[[!loadingPhotos]]> <paper-spinner active$=[[loadingPhotos]]></paper-spinner> Fetching photos </div> <iron-ajax id=ajax loading={{loadingPhotos}} handle-as=text on-response=_didReceiveResponse></iron-ajax> <iron-scroll-threshold id=scrollTheshold lower-threshold=500 on-lower-threshold=_loadMorePhotos scroll-target=document> </iron-scroll-threshold> </template> <script>HTMLImports.whenReady(function(){Polymer({is:"x-grid",properties:{apiKey:{type:String,value:"c304f1096a06486d3c1e7ab271bf7f3f"},photos:{type:Array,value:function(){return[]}},perPage:{type:Number,value:36},page:{type:Number,value:0},userId:{type:String,value:"142203852@N04"},totalPages:{type:Number,value:1},loadingPhotos:Boolean},attached:function(){this._updateGridStyles=this._updateGridStyles||function(){this.updateStyles()}.bind(this),window.addEventListener("resize",this._updateGridStyles)},detached:function(){window.removeEventListener("resize",this._updateGridStyles)},_getAPIEndpoint:function(e,t,s){return"https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key="+e+"&safe_search=1&sort=interestingness-desc&user_id="+t+"&page="+s+"&format=json&per_page="+this.perPage},_didReceiveResponse:function(e){var t=JSON.parse(e.detail.response.match("jsonFlickrApi\\((.*)\\)")[1]);t&&t.photos&&t.photos.photo&&(this.totalPages=t.photos.pages,t.photos.photo.forEach(function(e){this.push("photos",e)},this),this.$.scrollTheshold.clearTriggers())},_loadMorePhotos:function(){this.loadingPhotos||(this.page<this.totalPages?(this.page++,this.$.ajax.url=this._getAPIEndpoint(this.apiKey,this.userId,this.page),this.$.ajax.generateRequest()):this.$.scrollTheshold.clearTriggers())},_getItemStyle:function(e){return"background-image: url(//farm"+e.farm+".staticflickr.com/"+e.server+"/"+e.id+"_"+e.secret+"_b.jpg);"}})})</script> </dom-module> <x-grid></x-grid> </body> </html> 